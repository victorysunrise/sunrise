<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>SAS SVG</title>

	<script src="./JS/jquery/jquery.js"></script>
	<script src="./JS/d3v4/build/d3.min.js"></script>
    <script src="./JS/techan/dist/techan.js"></script>
    <script src="./JS/KIMLIB/SVG_lib.js"></script>

</head>



<body>
	<h2>SAS SVG</h2>





	<link rel="stylesheet" href="css/simpleexample.css">



	<script type="text/javascript">



		var svg = d3.select("body").append("svg")
					.attr("width",960)
					.attr("height",500)
					.attr("style","background:black")
		var x = techan.scale.financetime().range([0,960]);
		var y = d3.scaleLinear().range([500,0]);
		var candlestick = techan.plot.candlestick().xScale(x).yScale(y);
		
		d3.csv("../B002/M5/F_0023002.csv",function(error,data){ 

			var accessor = candlestick.accessor();
			data = data.map(Mapper_M5F).sort(function(a,b){return d3.ascending(accessor.d(a), accessor.d(b))});
			console.log(data);

			svg.append("g").attr("class","candlestick");

			x.domain(data.map(candlestick.accessor().d));

			ydomain = techan.scale.plot.ohlc(data,candlestick.accessor()).domain();
			var gg = getarrayby10(ydomain);

			console.log("y.domain = ", gg);
			y.domain(ydomain);

			svg.selectAll("g.candlestick").datum(data).call(candlestick);

			var ytickvalues = getarrayby10(ydomain);
			svg.append("g")
			   .attr("class","grid")
			   .style("stroke-dasharray",("3,3"))
			   .call(d3.axisLeft(y)
			   			.tickValues(ytickvalues)
			   			.tickSize(-960)
			   			.tickFormat("")
			   	);



		});



	</script>
</body>
</html>